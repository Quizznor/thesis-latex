%! TEX root = ../main.tex 

\chapter{The Pierre Auger Observatory}
\label{chap:pierre-auger-observatory}

The \PAO is the largest scientific experiment in the world, spanning an area of
roughly \SI{3000}{\kilo\meter\squared}. It consists of an array of 1660 \WCDs, 
which form the \SD, and 27 fluorescence telescopes, that comprise the \FD. Data
is collected at one location, the \CDAS, in the nearby city of Malargüe. The
hybrid detection of \CR-artifacts in the air and on ground via the simultaneous
operation of the \FD and the \SD offers a unique possibility to observe \UHECRs
at the tail-end of the \CR energy spectrum. 

\section{Project History and Future}
\label{sec:project-history-and-future}

\subsection{Science Goals and Achievements}
\label{ssec:science-goals-and-achievements}

The project that is today known as the \acl{PAO} looks back on a history which 
spans more than three decades in total. First plans for a \CR detector of
immense exposure were devised by Nobel laureate James Cronin 
\cite{nobelprizeoutreach2025NobelPrizePhysics} and Faraday medalist Alan Watson
\cite{FellowWinsIoP2011} at the 22nd \ICRC \cite{watsonDevelopmentPierreAuger}
They realized that the flux of \UHECRs is very low 
($\approx\SI{1}{\per\km\squared\per\year}$ for energies above \SI{1e19}{\eV} 
\cite{fenuCosmicRayEnergy2023}), and that one needs to observe a large area 
over a long timespan to collect enough data for a statistically relevant 
analysis of their dynamics. Cronin especially was interested in  verifying the 
possible detection of an astrophysical source of $\gamma$-rays 
\cite{samorskiDetection2101983}. Moreover, the mere existence of some \UHECRs 
was challenging astrophysical models \cite{birdDetectionCosmicRay1995, 
naganoAstrophysicalAspectsMost1991, hayashidaObservationVeryEnergetic1994,
lawrenceCosmicRayEnergy1991}. Naturally, probing the presence and possible 
sources of such \CRs of extreme energy became a priority for the envisioned 
experiment.

Cronin and Watson gathered support for their ideas and, in 1995, founded a 
collaboration of 140 likeminded scientists in 17 participating countries. A 
white paper was published that outlined the construction, capabilities, and 
cost of the \PAO \cite{thepierreaugercollaborationPierreAugerObservatory1997}. 
The detector configuration presented in the document varies from the design in 
use today. Most importantly, what was originally envisioned to be a detector 
with an active area of \SI{6000}{\km\squared} spread over two locations (Auger 
North and Auger South) had to be amended and only one site with and area of 
\SI{3000}{\km\squared}, located in the Argentinian Pampa Amarilla in the 
Mendoza province, came to be. There, the construction of an Engineering Array, 
a full scale prototype of the first \SD and \FD detectors was completed in 
2001. More hardware was added after first successful measurements, making the 
\PAO the largest observatory for \CRs by the end of 2003.

The detector has been operating almost continuously ever since, resulting in a 
total exposure well surpassing \SI{100000}{\km\squared\sr\year} 
\cite{aabPierreAugerObservatory2020}. Thanks to this, the Pierre Auger 
Collaboration has delivered key insights that advanced the understanding of 
astroparticle and high-energy physics. Most notably, the \PAO confirmed a 
strong suppression of the \CR-flux for particles above 
$E\approx\SI{4e19}{\eV}$ \cite{yamamotoUHECRSpectrumMeasured2007} (see 
\todo{ref physics chapter}). Anisotropies in the arrival directions of \UHECRs 
hint to their distant origins
\cite{thepierreaugercollaborationObservationLargescaleAnisotropy2017} (see 
\todo{ref physics chapter}). Upper limits have been set on the \UHE photon and
neutrino flux, which forces the reevaluation of certain astrophysical models 
\cite{collaborationPierreAugerObservatory2011, abreuSearchUltrahighEnergy2011}.
Last but not least, regular releases of datasets to the public support the work 
of independently working astrophysicists around the globe 
\cite{pierreaugercollaborationPierreAugerObservatory2025}.

\subsection{AugerPrime and Outlook}
\label{ssec:augerprime-and-outlook}

Many questions have been answered thanks to the data collected by the \PAO. It
is no surprise however that new insights sprout new questions. The existence of
\UHECRs beyond the GZK-cutoff has been established unambigously. Now, their
nature must be studied more deeply. Of particular interest is the 
reconstruction of the primary particle mass from \EAS-data, as this influences 
the \CRs (reconstructed \cite{yushkovMassCompositionCosmic2021}) energy, and 
evolution from the source to the earth 
\cite{strongCosmicRayPropagationInteractions2007, 
flaggsStudyingMassSensitivity2024}.

The detectors have undergone a major upgrade in the past decade in order to 
increase the observatories sensitivity to the primary particle mass. This 
overhaul, called AugerPrime, equips the \SD stations with additional detector 
channels and improved readout electronics. The \FD telescopes duty cycle was 
improved, and new methods for data analysis are being tested.

As of the completion of this thesis, the AugerPrime hardware and software 
upgrade is completed and described in the following pages as well as in 
\cite{collaborationPierreAugerObservatory2011}. The observatory delivers data 
with lower systematics and additional information from the new detectors. The 
prospects of this detector upgrade have astroparticle physicists excited, and 
resulted in the strong support to extend the observatories funding until beyond
the year 2030 \cite{castellinaOutcomeFinanceBoard2023}. The phase II of \DAQ 
(as opposed to Phase I pre- and during AugerPrime) will be the basis for many 
contributions that attempt to shed light into the physics of \UHECRs, with this
work being just one example.

\section{The Fluorescence Detector}
\label{sec:fd}

The \acf{FD} of the \PAO is a set of 27 reflector telescopes tuned to detect 
faint sources of \UV light. More specifically, the aim of the \FD is to observe
the \UV-emission of \EAS (see \todo{physics ref here}). However, since the 
solar irradiance ($\approx\SI{120}{\watt\per\meter\squared}$ 
\cite{leanContributionUltravioletIrradiance1989}) and even the lunar irradiance 
($\approx\SI{16}{\nano\watt\per\meter\squared}$
\cite{snowAbsoluteUltravioletIrradiance2013}) in the \UV-band far outshine the 
emission of \UV-light by cosmic rays ($<\SI{1}{\nano\watt\per\meter\squared}$, 
see \cref{app:cr-uv-irradiance}), the \FD can only operate after astronomical 
twiglight, and when the moon is not directly in the telescope \FOV, and not
more than 70\% illuminated as seen from Earth \cite{mathesCriteriaFDShift}. 
This drops the duty cycle to approximately 13\% 
\cite{abrahamFluorescenceDetectorPierre2010}.

The telescopes are grouped at five \FD sites, where a collection of six (three
in one case) identical setups offer a $6\cdot30^\circ=180^\circ\times30^\circ$ 
view (Azimuth $\times$ Elevation) over the \SD array. \cref{fig:auger-map} 
shows their location. Starting anticlockwise with the telescopes located 
closest to Malargüe, these sites are \LL, \LM, \LA, \CO2, and the \HEAT.

\begin{figure}[t]
  \centering
  \subfloat[]{\includegraphics[height=0.45\textwidth]{auger-observatory/auger_array-small.png}
  \label{fig:auger-map}
  }\hspace{0.2cm}
  \subfloat[]{\includegraphics[height=0.45\textwidth]{auger-observatory/fd_schematic.png}
  \label{fig:fd-schematic}
  }
  \caption[]{\subref{fig:auger-map} Overview of the \PAO and its' detector 
  components. The black dots mark the placement of \WCDs in the \SD. The blue 
  lines indicate the location and \FOV of the \FDs. \HEAT (red) and \CO 
  overlook the SD-750 Infill area, where a denser spacing of stations separated
  by \SI{750}{\meter} complement the SD-1500 main array. From 
  \cite{vebericIndexHttpWebiapkitedu}. \subref{fig:fd-schematic} Cross section 
  of the components of a single telescope, located in an \FD building, modified 
  from \cite{abrahamFluorescenceDetectorPierre2010}.}
  \label{fig:pao-images}
\end{figure}


\subsection{Optical System}
\label{ssec:fd-design}

The \FD telescopes are designed following the schematic of a Schmidt camera 
with corrector plates. The individual components located on the optical axis 
are, in the order that light traverses them (see \cref{fig:fd-schematic}, 
\cref{fig:fd-inside-view} and \cite{abrahamFluorescenceDetectorPierre2010}):

\begin{enumerate}[label=(\Alph*)]
  \item \textbf{The shutter}, which consists of two massive metal doors, 
  shields the aperture from atmospheric influences such as strong winds or 
  rain. It also serves as a light shield that protects the sensitive camera 
  electronics during the day.

  \item A \textbf{MUG6 \UV Filter} is installed in the light path in order to 
  block visible light from entering the telescope. It separates the climate 
  controlled inside of the \FD buildings from the outside via a circular
  aperture that measures \SI{2.2}{\meter} in diameter. 
  
  \item \textbf{Corrector lenses} are located in a ring around the edge of the 
  aperture. The ring has an inside diameter of \SI{1.7}{\meter} and manages to 
  increase the light collection area, while minimizing spherical aberrations in
  the camera.

  \item \textbf{The curtain} curtain provides a secondary failsafe that 
  prevents high-intensity light from reaching the sensitive electronics. The 
  curtain sits outside of the light path, but can be deployed in emergency 
  situations, or during daytime work and maintenance.

  \item \textbf{The mirrors} are a set of 60 hexagonal glass segments (36 
  square segments from anodized aluminum in the case of \LL and \LM) aligned 
  in a concave $\SI{3.6}{\meter}\times\SI{3.6}{\meter}$ shape, which reflects 
  and concentrates incoming light towards the camera.

  \item For \textbf{the Camera} refer to the next \cref{ssec:fd-camera}.
\end{enumerate}

\subsubsection{High Elevation Auger Telescope}
\label{sssec:HEAT}

The fifth and newest \FD-site, the \acl{HEAT} commissioned 2009, is located 
close to \CO, and looks out over the SD-750 array with three fluorescence 
telescopes. The setup of the optical system is (conceptually) identical to that
of the standard \FD-sites. However, in the case of \HEAT, the entire telescope 
building can be rotated upwards by $30^\circ$. This allows the observation of 
the upper atmosphere, where lower energy \EASs are more prevalent. \HEAT 
extends the energy scale seen by the \FD by one order of magnitude 
\cite{mathesHEATTelescopesPierre2011}.

\subsection{Readout Electronics}
\label{ssec:fd-camera}

The camera for each telescope consists of 440 Photonis XP3062 \PMTs that serve 
as the individual pixels. The specific model is chosen because it minimizes 
afterpulsing in the anode trace, and has a reasonable quantum efficiency 
($\approx30\%$) at the target wavelength (\SIrange{350}{400}{\nano\meter}) that 
the \FD monitors \cite{xiaoCalibrationPhotonisXP30622005}. The \PMTs are 
arranged in 22 rows and 20 columns. Each pixel has a solid angle acceptance of 
$\Omega = \SI{5.94e-4}{\sr}$. Reflective star shapes with threefold symmetry 
sit between neighbouring pixels to boost light collection efficiency, as well 
as increase the camera point resolution. Finally, the voltage at the anode of 
the \PMTs is read out at a sampling frequency of \SI{10}{\mega\hertz} 
(\SI{20}{\mega\hertz} for \HEAT) and digitized by 12-bit \ADC-converter stages. 

\subsection{Event Detection}
\label{ssec:fd-triggers}

The accurate reconstruction of an \EAS requires the camera to have an excellent
background rejection (of e.g. transient stars in the camera \FOV). On top of 
this, signals must be processed quickly to keep a potential timing offset 
between \FD and \SD minimal, and enable a hybrid reconstruction. The \FD 
electronics achieve this via a simple, hierarchical trigger logic. A \FPGA 
scans the incoming signal from one column of pixels in a \FLT-stage. It 
calculates the running sum of the last 16 (baseline\footnote{calculated as the 
mean \ADC value over 65536 ($\cong\SI{6.554}{\milli\second}$) samples} 
subtracted) \ADC samples per pixel and compares the result to a reference 
threshold. If the sum exceeds the reference threshold a \FLT is issued and the 
pixel data is written to a \SRAM. This achieves two things. First, the number 
of \FLTs over a period of time is used to calculate an \FLT rate per pixel. The
reference threshold is updated according to this trigger rate, such that the 
\FLT matches a \SI{100}{\hertz} trigger rate. Secondly, the number of 
simultaneous \FLTs per column, or multiplicity, is evaluated and passed on to 
the \SLT-stage.

There, the active pixels (that have raised a trigger in the last 
\SI{100}{\nano\second}) are searched for spatial correlations. If a collection 
of at least 4 pixels are found whose layout corresponds to a set of predefined
masks a \SLT is issued. These predefined masks aim to identify straight tracks 
in the camera \FOV, and decrease the trigger rate from 
$\SI{100}{\hertz\per\mathrm{pixel}}$ in the \FLT to 
$\SIrange[range-units = single]{0.1}{10}{\hertz\per\mathrm{telescope}}$ in the 
\SLT. Following, a \TLT separates true air shower events from noise with 
$\approx94\%$ accuracy by performing a data-based cut on the multiplicity of 
active pixels \cite{abrahamFluorescenceDetectorPierre2010}. This reduces the 
trigger rate to $\SI{0.01}{\hertz\per\mathrm{telescope}}$. 

\subsection{Telescope Calibration}
\label{ssec:fd-calibration}

The description of the event reconstruction in \cref{sec:event-reconstruction}
will reveal that in order to estimate the primary particle energy the number of
photons incident on the \FD-camera need to be known. This poses a big 
challenge. While the camera signal response correlates with the number of 
photons observed per \EAS, the correlation coefficient is completely determined
by the gain of the telescope readout electronics, which need not be constant. 
It has been shown that the camera response to the same signal can change by up 
to $6\%$ under suboptimal conditions \cite{filipJumpsXYCalibration2024}.

To account for this, the \PMTs need to be calibrated on a nightly basis. During
calibration the camera is exposed to a lightsource of known radiance, and the 
camera response (in units of \ADC) is logged. Tying all information together, 
this allows the calculation of (absolute) pixel calibration constants, 
$C^\mathrm{pixel}_\mathrm{abs.}$, in units of \SI{}{$\gamma$\per\ADC}. It is
imperative that these quantities are measured with high precision, as
uncertainties on $C^\mathrm{pixel}_\mathrm{abs.}$ contribute linearly to the 
uncertainty of the reconstructed primary particle energy. Currently, the pixel
calibration constants are measured with an uncertainty of approximately $9\%$
\cite{dawsonUpdateAugerEnergy13}. This represents the biggest contribution to 
the total uncertainty in the \PAO energy scale of $14\%$ 
\cite{verziEnergyScalePierre2013}.

\subsubsection{Atmospheric Laser Shots}

The \PAO operates two atmospheric lasers, the \CLF, and the \XLF 
\cite{collaborationTechniquesMeasuringAerosol2013}. Their primary science case 
is monitoring atmospheric conditions in order to model the development of \EASs
accurately. The two instruments provide vertical laser beams with stable power,
that, due to their very narrow frequency spectrum, translate to a stable
output of photons. In theory, the number of photons that scatter off of air 
molecules and hit the \FD-cameras per laser pulse is calculable. Analyzing the
telescope response to these laser pulses allow for an absolute calibration of 
\FD-\PMTs. In practice this proves impractical however. The air conditions in 
the atmosphere are not known with sufficient precision. Moreover, not all
pixels in all telescopes see the laser beams, which drastically lowers the 
accuracy of the presented method.

\subsubsection{Drone Based Calibration}

A remote-controlled drone equipped with a light source is used to simulate a 
distant point source in the \FD-\FOV \cite{wernerDesignTestFlying2010, 
tomankovaOpticalPropertiesCalibration2016}. In principle the hardware can be
used to calibrate the individual pixels of a camera, as the source radiance is
known. In practice the drone based approach takes a long time to illuminate 
every pixel. Other methods are less time intensive and therefore preferred. 
Nevertheless, the drone proves useful in measuring the optical properties of 
the \FD-mirrors, such as the \PSF \cite{ungerSimulationPointSpread2013}.

\subsubsection{Drum Calibration}

\begin{figure}[t]
  \centering
  \subfloat[]{\includegraphics[height=0.32\textwidth]{auger-observatory/fd_camera.png}
  \label{fig:fd-inside-view}
  }\hspace{0.1cm}
  \subfloat[]{\includegraphics[height=0.32\textwidth]{auger-observatory/drum_mounting.png}
  \label{fig:drum-mounting}
  }\hspace{0.1cm}
  \subfloat[]{\includegraphics[height=0.32\textwidth]{auger-observatory/cal_a_response.png}
  \label{fig:cal-a-example-response}
  }
  \caption[]{\subref{fig:fd-inside-view} View of the inside of an
  \FD-telescope. The different detector components are labelled and described 
  in more detail in \cref{ssec:fd-design}. Picture from 
  \cite{pierreaugerobservatoryP22500022004} 
  \subref{fig:drum-mounting} The drum light source is mounted in front of the 
  aperture of a telescope at \CO for an absolute calibration. From 
  \cite{crissUpdateRecentAbsolute2010}. \subref{fig:cal-a-example-response} The
  integral signal per pixel received by the camera in bay 2 of \CO for a 
  relative calibration measurement (cal. A) before standard \DAQ on 2024-11-20.}
  \label{fig:camera-stuff}
\end{figure}

The absolute calibration method currently in use at the \PAO is the drum 
calibration. The name derives from the shape of the light source, visible in 
\cref{fig:drum-mounting}. It is a cylinder with a diameter of \SI{2.5}{\meter} 
and depth of \SI{1.4}{\meter} with two NSHU550 \UV \LEDs installed at its' 
center. A reflective laminate uniformly distributes the light from the \LED 
over the interior of the drum \cite{brackAbsolutePhotometricCalibration2004}. 
The radiance of the lightsource is carefully measured before, during, and afte 
every \DAQ campaign \cite{brackAugerFluorescenceDetector2013}. To measure 
$C^\mathrm{pixel}_\mathrm{abs.}$ via the drum lightsource the cylinder frame 
has to be mounted on top of the \FD aperture. Once done, all pixels in the 
telescope camera are illuminated simultaneously with a single \LED pulse and 
the signal response can be read out.

While the measurement itself is quick it requires time, manpower, and knowledge
to set up. For this reason the last absolute calibration of the \FD-telescopes 
with the drum lightsource has been conducted more than ten years ago in 2013 
\cite{dorofeevFDAbsoluteCalibration2013}. 

\subsubsection{Calibration A, B and C}

In order to address the lack of a nightly absolute calibration relative 
calibration systems exists to track the telescope evolution over time. These 
relative calibration systems are a set of \LCUs and identical for each building
\footnote{\HEAT has one copy for each of its' telescopes}.
They consist of three central \LED light source and optical fibers that 
transport photon signals to diffusers located at three different exit ports at 
the six different telescopes \cite{robertsCalibrationPierreAuger2003}. The 
location of the exit ports are as follows:

\begin{enumerate}[label=(\Alph*)]
	\item In the center of the mirror, directly illuminating the 
	\FD-camera.
	\item Above the camera body, illuminating the pixels indirectly via the
	mirror.
	\item Outside the \FD building and pointed towards the shutter.
	Reflective liners on the inside of the shutter redirect the light into 
	the aperture and eventually the camera.
\end{enumerate}

In principle, the combination of Calibration A, B, and C allow to monitor the 
aging of the different detector components, and provide an end-to-end 
calibration, in which the whole optical system of the telescopes is probed. 
Only Calibration A is performed to track changes in the pixel-\PMTs in 
practice. The  remaining telescope constituents have been shown to be stable 
over the timespan of years \cite{brackAugerFluorescenceDetector2013, 
dorofeevFDAbsoluteCalibration2013}.

Two Calibration A measurements are performed during each night. One before the 
start of \DAQ, and one after the data-taking ends. During the measurement the 
\LED emits 50 light pulses with a duration of $\approx\SI{60}{\micro\second}$ 
at a wavelength of \SI{470\pm25}{\nano\meter} 
\cite{menshikovLEDCalibrationUnit}. The optical signal is guided through six 
cables to the diffusers at the center of the mirror. A seventh fiber feeds the 
light back to the \LCU, where a photodiode digitizes the signal 
$S_\mathrm{LCU}$. The readout of pixel-data is forced via an external trigger 
coincident with every light pulse. The overall signal recorded in the \FD time 
trace from the calibration light pulse(s), $S_\mathrm{CalA}$, can be recovered 
by first estimating and subtracting the trace baseline 
\cite{schaferReconstructionBaselineUndershoot2022}, determining the pulse start
and stop via a pulse-finding algorithm (see \todo{xy section ref here}), and 
summing the \ADC bins within the pulse-window. 
\cref{fig:cal-a-example-response} shows example data analyzed in this fashion. 
From $S_\mathrm{LCU}$ and $S_\mathrm{CalA}$ the calibration constants measured 
in a reference night via calibration method $i$ can be forward- or 
backpropagated to an arbitrary point in time according to 
\cite{salinaNewCalibrationTask2014, salinaAnalisiDatiXY2025} like

\begin{equation}
\label{eq:cal-a-propagation}
C^{\mathrm{pixel},\,i}_{\mathrm{abs.}} = C^{\mathrm{pixel},\,i}_{\mathrm{abs.},\,\mathrm{ref}}\,\cdot\,\frac{S_\mathrm{LCU}}{S_\mathrm{LCU}^\mathrm{ref.}}\,\frac{S_\mathrm{CalA}^\mathrm{ref.}}{S_\mathrm{CalA}}\,c_\mathrm{LCU}^\mathrm{Corr.}\,c^\mathrm{Corr.}_\mathrm{Halo}.
\end{equation}

In \cref{eq:cal-a-propagation} the two factors $c^\mathrm{Corr.}_i$ give 
different corrections to the end result that need to be considered. First, a 
time-dependant factor $c^\mathrm{Corr.}_\mathrm{LCU}$ absorbs the change of 
radiance in the \LCU \LED after a replacement in 2011/2012 took place in all 
telescopes \cite{menshikovLEDCalibrationUnit}. A second factor accounts for the
fact that not all photons that hit the camera body are registered in the \PMTs. 
Some light is reflected away, and does not contribute to the absolute 
calibration. Consequently, $C^{\mathrm{pixel},\,i}_\mathrm{abs.}$ would be 
underestimated without a correction factor $c^\mathrm{Corr.}_\mathrm{Halo}$ 
\cite{brackFluorescenceDetectorAbsolute13}.

\subsubsection{XY Scanner}
\label{sssec:xy-scanner}

The XY-Scanner is a novel end-to-end calibration method that aims to be the
successor of the drum calibration system 
\cite{engelNewEndtoendCalibration2017}. It consists of a portable \IS 
lightsource mounted on an XY translation stage. Instead of illuminating the 
entire aperture with a single flash of a big lightsource, the XY-Scanner fires 
many flashes from different positions in the aperture. This compromises 
measurement time for much easier handling and better systematics on the 
resulting pixel calibration constants. The setup and analysis of the method are
summarized in \todo{xy scanner chapter here}, and described in detail in 
\cite{schaferXYScannerVersatileMethod2023}

\section{The Surface Detector}
\label{sec:sd}

The \acf{SD} are a collection of more than 1660 stations spread in a regular 
pattern over the surface of the Pampa Amarilla. The position of each station is
shown in \cref{fig:auger-map}. Each station is equipped with hardware that 
offers several detection channels to ionizing particles on the ground. Their 
remote location complicates maintenance work and the transfer of measurement 
data. For this reason the stations are operating largely autonomously, only 
communicating essential information to the \CDAS (see \cref{sec:cdas}). They 
derive their electrical power from a solar panel, and have (limited) 
computational resources at hand that control communication with the \CDAS, data
readout, and run procedures to self-calibrate the individual detectors. 

\subsection{Detector Components}
\label{ssec:detector-components}

The main detector and processing components (\WCD, \UUB, etc.) are presented in
the following subsections. Some auxiliary hardware components (auxiliary in the
context of this work, not the function of the stations) are only briefly 
mentioned here:

\begin{itemize}
	\item Two $\SI{55}{\watt}_\mathrm{peak}$ solar panels provide 
	electricity during solar periods 
	\cite{collaborationPierreAugerObservatory2016}.
	\item Two \SI{105}{\ampere\hour} batteries deliver power during	the 
	dark \cite{collaborationPierreAugerObservatory2016}.
	\item A Motorola Oncore UT+ \GPS-receiver determines the position of 
	the station using a pulse precision of \SI{5}{\nano\second} 
	\cite{networktimefoundationMotorolaOncoreGPS} ($\cong\SI{1.5}{\meter}$
	position accuracy).
	\item A commercial \SI{12}{\dBi} Yagi antenna \cite{rfwel12DBiYagi} 
	establishes communication with the \CDAS.
\end{itemize}

\subsubsection{Water Cherenkov Detector}
\label{sssec:wcd}

\begin{figure}[t]
  \centering
  \subfloat[]{\includegraphics[height=0.37\textwidth]{auger-observatory/sd_station.png}
  \label{fig:sd-station-render}
  }\hspace{0.2cm}
  \subfloat[]{\includegraphics[height=0.37\textwidth]{auger-observatory/SSD_high_contrast.png}
  \label{fig:ssd-high-contrast}
  }
  \caption[]{\subref{fig:sd-station-render} A model of an \SD-station, showing
  wht the label (A) the \RD, (B) the comms antenna, (C) the \SSD, (D) the solar
  panels, (E) the electronics box containing the \UUB, and (F) the inside of 
  the \WCD with the three \LPMTs. Adopted with changes from 
  \cite{filipPotentialNeuralNetwork2023}. \subref{fig:ssd-high-contrast} The 
  \SSD without enclosing box, showing the individual scintillator strips and 
  \WLSs. From \cite{schmidtUHECR2024ProceedingEdits25}.}
  \label{fig:sd-station-components}
\end{figure}

The \acf{WCD} is the main detector component, and common to all \SD-stations 
since the construction of the \PAO began. It is an oblate cylinder with a 
diameter of \SI{3.6}{\meter} and height of $\SI{1.2}{\meter}$ as seen in 
\cref{fig:sd-station-render}. The interior is filled with a sealed liner 
containing \SI{12000}{\liter} of filtered water, and shielded from exterior 
light via a polyethylene housing \cite{allekotteSurfaceDetectorSystem2008}. The
darkness in the cylinder is occasionally interrupted by flashes of light 
stemming from relativistic particles producing Cherenkov radiation in the 
water. This light bounces off of the reflective interior walls until it reaches
one of three identical \SI{230}{\milli\meter} Photonis XP1805 \LPMTs 
\cite{tripathiSystematicStudyLarge2003} that are optically coupled to the 
inside volume of the liner.

The \WCD needs to be able to accurately reconstruct a large dynamic range of
signals, starting from individual particles to $>10^3$ muons entering the water
\cite{abrahamTriggerApertureSurface2010}. To achieve this, the \LPMTs 
characteristics are monitored by two channels, the \HG and the \LG. The \LG 
is connected directly to the dynode of the \PMTs, whereas the \HG tracks the 
anode voltage. The \HG-channel is thus amplified to have a gain ratio of 
$\sim32$. Both channels are read out via 12-bit AD9628 \FADCs 
\cite{analogdevicesinc.AD9628DatasheetProduct2015} at a sampling rate of \SI{120}{\mega\hertz} (corresponding to a binning of \SI{8.333}{\nano\second}). 

A fourth, \SI{25}{\milli\meter} \SPMT of type Hamamatsu R8619 
\cite{hamamatsuphotonicsPhotomultiplierTubeR8619} is installed near the center
of the tank. It is exposed to less light due to its relatively small size, and 
extends the dynamic range of the \WCD to about \SI{20000}{\VEM}.

The same considerations as in \cref{ssec:fd-calibration} apply to the data
recorded by the \WCD (and all other \SD components). The detector information 
needs to be put into a physical context in order to be interpreted correctly.
For the particle detectors at the \PAO (\WCD, \SSD, and \UMD) this context is 
given by atmospheric muons, as they have a characteristic energy deposit and 
signature in the active medium. The measurement data (in units of \ADC) is
converted to the quantity of muons (or \MIPs, in the case of the \SSD) that
would be needed to be injected vertically\footnote{To absorb dependencies of 
the track length in the detector} in the detector to record the same signal 
strenght. This, for the \WCD, gives raise to two quantities that need to be 
tracked in order to provide calibrated data:

\begin{itemize}
	\item \Ivem is the most probable pulse height (in units of \ADC) 
	recorded by the \WCD \PMTs when a muon passes vertically through the 
	center of the water volume.
	\item \Qvem gives the most probable value (measured in \ADC as well) 
	for the integral of the muon pulse, corresponding to the energy 
	deposited in the detector by the particle.
\end{itemize}

The trigger thresholds (compare \cref{ssec:sd-triggers}) in the \WCD are set in
terms of \Ivem. For this reason, the stations operate a self-calibration
algorithm that delivers a rate-based estimate of \Ivem, called \VemOnline that 
is accurate to within $\sim5-10\%$ \cite{bertouCalibrationSurfaceArray2006} of 
the true value of \Ivem.

The value of \VemOnline is adjusted by a simple and robust algorithm. It 
employs a calibration trigger that requires a coincident signal of at least 
\SI{1.75}{\VemOnline} in all three \LPMTs. In the case of one or more tubes
being broken the trigger thresholds are adjusted in order to ensure the stable 
operation of the remaining \PMTs 
\cite{convengaLocalStationCalibrationDummies2023}.

An additional cut of \SI{2.5}{\VemOnline} is applied per \LPMT, and the number 
of triggers during a timespan measuring at most \SI{60}{\second} is tracked. If
the trigger rate of the calibration trigger exceeds a target rate of 
\SI{72}{\hertz} during this period, the value of \VemOnline is increased. This 
results in more stringent trigger conditions, and will decrease the trigger 
rate during the following \DAQ period. Similarly, the value of \VemOnline is 
decreased if the calibration trigger rate is lower than \SI{68}{\hertz}. If the
trigger rate lies within \SI{70\pm2}{\hertz} the \DAQ period is increased 
(beginning with \SI{10}{\second}) by \SI{5}{\second} to limit the influence of 
Poissonian noise on the estimate \cite{bertouCalibrationSurfaceArray2006, 
convengaLocalStationCalibrationDummies2023}.

Under nominal conditions, this results in the value of \VemOnline being updated
every minute. Most importantly, this implies that the trigger thresholds of 
station-level event triggers (see \cref{ssec:sd-triggers}) adjust to the
changing environmental conditions in the array. Additionally, the value of 
\VemOnline is packaged among other diagnostic information, and sent to the 
\CDAS every \SI{400}{\second} for monitoring purposes. This allows for the easy
identification of non-functioning stations, as these will show an abnormal 
value or evolution of \VemOnline in one or more of the three \LPMTs. 

An alternative method of calibration exists, that is used during event 
reconstruction (i.e. not on a station-level). It analyzes the distribution of 
low-energy pulses in the detector, and forms a more accurate estimator, 
\VemOffline, as described in \todo{ref here}

\subsubsection{Surface Scintillator Detector}
\label{sssec:ssd}

With the AugerPrime detector upgrade, the \SSD has been installed on every 
\SD-station. It sits atop the \WCD as seen in \cref{fig:sd-station-render}, 
with an aluminum box shielding the sensitive electronics from the environment. 
As the name implies, the active area of the detector 
(\SI{3.84}{\meter\squared}) is made up of polystyrene scintillator strips 
measuring \SI{1600}{\centi\meter} in length, \SI{5}{\centi\meter} in width, and
\SI{1}{\centi\meter} in thickness \cite{cataldiUpgradePierreAuger2022}. These 
strips produce light via molecular (de-) excitation when ionizing particles 
pass through them, with the amount of light being inversely proportional to the
change in energy of the traversing particles.

The scintillating light is reflected by a TiO$_2$ external coating of the bars,
and eventually captured by \WLS cables running through the long end of each 
segment. An example of this is given in \cref{fig:ssd-high-contrast}. From 
there, the \WLSs are arranged in a "U" configuration, where both ends of each 
cable are coupled via optical cement to a \SI{38}{\milli\meter} Hamamatsu R942 
\PMT \cite{hamamatsuphotonicsPhotomultiplierTubeR9420}. This allows the 
efficient transport of photons from the source to the readout location. The
electronics responsible for digitizing the signal of the \SSD \PMT have similar
specifications to those of the \WCD 
\cite{collaborationPierreAugerObservatory2016}.

A crucial difference between the \WCD and the \SSD is their response to the 
\EM-component of \EASs. While the \WCD is mostly sensitive to muons, the \SSD,
relying only on ionization processes, shows the same signal strength for muons
and electrons. This is the science case of the \SSD. Utilizing the knowledge of
the \WCD and \SSD allows the disentanglement of the individual shower 
components. This results in an improved sensitivity to the primary particle
mass (compare \todo{write \EAS chapter} and 
\cref{ssec:augerprime-and-outlook}).

Similar to the \WCD, the \SSD must be calibrated. For the case at hand, the 
characteristic quantities that are of significance are those of an arbitrary 
\acf{MIP}:

\begin{itemize}
	\item \Imip is the most probable pulse height (in units of \ADC) 
	recorded by the \SSD \PMT when a \MIP passes vertically through a 
	random location in the \SSD active medium.
	\item \Qmip is the most probable pulse integral recorded during the 
	aforementioned event.
\end{itemize}

The details of how \SSD data is calibrated during event reconstruction can be
found in \todo{ref here}. Additionally, a novel algorithm developed in this
work allows the estimation of \Imip on a station-level. Implementation details 
can be found in \todo{ref here}.

\subsubsection{Underground Muon Detector}
\label{sssec:umd}

\begin{figure}[t]
  \centering
  \subfloat[]{\includegraphics[height=0.33\textwidth]{auger-observatory/underground_muon_detector}
  \label{fig:umd}
  }\hspace{0.2cm}
  \subfloat[]{\includegraphics[height=0.33\textwidth]{auger-observatory/uub_annotated.png}
  \label{fig:uub}
  }
  \caption[]{\subref{fig:umd}The three modules of a \UMD in their final 
  location before being covered with soil. Additional solar panels in the 
  background provide electrical power for the detector. From 
  \cite{pierreaugercollaborationUMDUndergroundMuon} \subref{fig:uub} The \PCB
  design of the \UUB. Connection with the front-end electronics is made via the
  golden connectors on the bottom. Image adopted with changes from 
\cite{nitzNewElectronicsSurface2021}.}
  \label{fig:umd-and-uub}
\end{figure}


The \UMD represents another enhancement installed during the AugerPrime 
detector upgrade. It further boosts the observatories primary mass 
discrimination abilities \cite{collaborationPierreAugerObservatory2016}. In 
total 73 \UMDs are buried underground, each one in close vicinity to an SD-750 
or SD-433 station. These installations comprise the \acf{AMIGA} detector.

Each \UMD consists of three \SI{10}{\meter\squared} scintillator modules that 
are, like the \SSD, segmented themselves into bars to minimize signal pileup
\cite{bottiStatusPerformanceUnderground2022}. They are buried \SI{2.3}{\meter} 
underground, as shown in \cref{fig:umd}. The soil above the detectors provides 
an excellent attenuation for non-muonic particles in \EASs. Particularly, this 
implies that the signals measured by the \UMD consist entirely of muons, 
allowing the \PAO to e.g. probe the muon content of \EASs \todo{cite joachims thesis}.

\WLS cables transport the light signal from the active medium of one bar to a 
dedicated \SiPM. The output of the \SiPM array is digitized in two ways 
\cite{aabCalibrationUndergroundMuon2021}:

\begin{itemize}
	\item 64 binary traces, that read either 1, or 0, depending on if the 
	corresponding \SiPM signal is above or below a threshold of 
	\SI{2.5}{photo-equivalents}\footnote{meaning roughly two and a half
	(out of 1584) photo-diodes in the \SiPM trigger an electron avalanche.}
	\cite{bottiStatusPerformanceUnderground2022}.
	\item one \ADC trace that sums all 64 \SiPM signals. Split into \HG and
	\LG channels.
\end{itemize}

This approach is chosen to retain the large dynamic range of signals that the 
detector needs to support. Individual muons can be reconstructed by examining
the binary mode of the \UMD, and the muon density of up to 
$\sim\SI{30}{muons\per\meter\squared} $ during a high-energy \EAS event is 
obtained from the \ADC mode \cite{bottiStatusPerformanceUnderground2022}.

This is done in practice by dividing the observed pulse integral, or charge, by
the most probable charge obtained from a single-muon event, $Q_\mathrm{UMD}$. 
This is a familiar problem, and has been solved for the \WCD already. A similar
strategy for the calibration of the \UMD \EAS data is thus chosen during event 
reconstruction \cref{ssec:offline-event-reconstruction}. The \UMD does not need
to be self-calibrating, as it is run purely in a secondary mode to the \WCD, 
and does not generate triggers itself \cite{aabCalibrationUndergroundMuon2021}.

\subsubsection{Radio Detector}
\label{sssec:rd}

The \RD represents the last, and newest detector component that was added to 
the \SD. Since the completion of construction at the end of 2024 
\cite{castellinaSeasonalGreetings202424}, all \SD stations have been equipped
with \SALLAs, consisting of a dipole loop with radius \SI{60}{\centi\meter} 
that are mounted on top of the \SSD (ref. \cref{fig:sd-station-render}). This 
configuration allows the detection of the \EM signature of \EASs from arbitrary
directions in the frequency band 
\SIrange[range-units = single]{30}{80}{\mega\hertz} 
\cite{pontLargeRadioDetector2021}, and was chosen after a thorough \RND phase 
of the \AERA prototype detector \cite{aabPierreAugerObservatory2020, 
fuchsAugerEngineeringRadio2012, aabEnergyEstimationCosmic2016}.

The \RD is only sensitive to macroscopic changes in the \EM field, and cannot 
rely on muon signals for calibration. For this reason, the signal power 
received by the antenna is compared to the time- and frequency-dependent 
expected signal of the galactic radio background instead. This provides a 
measure of the antenna directional gain that agrees to within $\sim5\%$ with 
simulations \cite{huegeRadioDetectorPierre2023, 
fodranFirstResultsAugerPrime2022}.

\subsection{Station Electronics}
\label{ssec:uub}

The \UUB, replacing the \UB in the AugerPrime detector upgrade, hosts all main 
electronic readout components of the station 
\cite{collaborationPierreAugerObservatory2016}. \cref{fig:uub} and 
\cref{fig:uub-circuit-diagram} show the design and architecture of the \UUB 
\PCB respectively, and \cite{suomijarviNewElectronicsSurface2018} details the 
exact implementation and purpose of each component. 

Highlighted for this work are the operative functions of the Artix-7 \FPGA 
\cite{xilinx7SeriesFPGAs2020}, which is responsible for low-level signal 
processing, as well as the tasks of the Xilinx Zynq-7020 \SOC, equipped with a
dual-core \CPU \cite{amdZynq7000SoC2023} that handles higher-level programming 
logic. 

\subsubsection{FPGA and Memory Buffers}
\label{sssec:fpga-buffers}

The main purpose of the \FPGA is to read out the 
$\SI{5}{\PMTs} \cdot (\HG + \LG) = 10$ different channels of detector data and 
compare them against various trigger criteria (see \cref{sssec:wcd}, 
\todo{ref}) \cite{nitzUUBV2Analog18}. If a trigger condition is met, the \FPGA 
stores the data in memory for further processing. The memory address is 
determined by the type of raised trigger. Four \FIFO ring buffers are available
for writing and separated in their purpose. Two instances of these circular 
memory modules comprise the muon buffer, and two form the shower buffer. 

The former contains events that surpass \SI{30}{\ADC} (\SI{70}{\ADC}) above 
baseline in any of the \WCD \LPMTs (\SSD PMT) for at least one sample. Once 
this is the case, the last 19 bins, the latch bin, as well as the next 49 bins 
(concluding in total 69 bins $\cong\SI{0.575}{\micro\second}$) from the \WCD 
and \SSD \HG channels are stored, with the \FPGA alternating writing to both 
ring buffers, to avoid dead times. This process occurs at a rate of 
$\sim\SI{3}{\kilo\Hz}$. The muon buffer is then read out by the \CPU in 
real-time to construct muon histograms (see \cref{sssec:muon-histograms}) that 
provide an accurate method to calibrate the \WCD and \SSD.

The shower buffer contains events that satisfy \TTWOs (compare 
\cref{ssec:sd-triggers}). These occur at a, due to the stations 
self-calibration, fixed rate of $\sim\SI{20}{\hertz}$. This is a far lower rate
than that of the muon buffer, but the volume of information contained in the 
shower buffer is far more exhaustive. Upon a \TTWO, 2048 samples 
($\cong\SI{17.07}{\micro\second}$) of all ten \HG and \LG channels are stored 
in the circular buffer. This data is the raw event data that gets sent to the 
\CDAS upon a \TTHREE request (see \cref{sssec:sd-triggers}). In total, the two 
shower buffers can hold up to 1024 \TTWO events 
\cite{wainbergDigitalElectronicsPierre2014}, meaning that at a nominal \TTWO
rate, events are overwritten after $\sim\SI{50}{\second}$. In practice, not 
more than $\sim\SI{8}{\second}$ are needed for the \CDAS to request \TTWO 
information\footnote{Thunderstorms can cause large backlogs in \TTHREEs. For 
this, a fix was presented in \todo[inline]{cite icrc2025 proceeding}.}
\cite{collaborationPierreAugerObservatory2016}.

\subsubsection{Muon Calibration Histograms}
\label{sssec:muon-histograms}

\begin{figure}[t]
  \centering
  \subfloat[]{\includegraphics[height=0.34\textwidth]{auger-observatory/ssd_histo.png}
  \label{fig:ssd-histo}
  }\hspace{0.2cm}
  \subfloat[]{\includegraphics[height=0.34\textwidth]{auger-observatory/filter_and_downsample.png}
  \label{fig:filter-and-downsample}
  }
  \caption[]{\subref{fig:ssd-histo} Example calibration histogram for \Qmip. A
  specialized \DAQ setup allows for the distinction of vertical (solid black
  line) and omnidirectional (dashed red line) events 
  \cite{assisMeasurementWaterCherenkovDetector2016}. Data is from 
  \cite{sarmentoVerticalVsOmnidirectional2024}. 
  \subref{fig:filter-and-downsample} Comparison between the simulated \WCD 
  response in a \UUB \FBW trace (top), and its' \FDS counterpart (bottom). 
  Pulse heights recorded from the same signal are $\sim\SI{15}{\percent}$ lower
  for the \FDS trace \cite{convengaLocalStationCalibrationDummies2023}.
}
  \label{fig:uub-trace-details}
\end{figure}

The muon buffers presented in \cref{sssec:fpga-buffers} contain data from short
pulses recorded mostly from single muons passing through the water volume. 
Since muons in \EASs are produced in the minimum of the Bethe-Bloch curve they 
have a characteristic energy deposit and detector signature in the \WCD and 
\SSD. To utilize this knowledge in calibrating the detectors, the \CPU analyzes
all $n$ traces (containing 69 samples $b_i$ of data) collected in the muon 
buffer over the last \SI{61}{\second} and calculates the baseline $B$, and 
peaks $I_n$, and charges $Q_n$ per trace as 

\begin{equation}
\label{eq:peak-and-charge}
B = \frac{1}{n} \sum^n_{i=1} b_{0,\,i}\,, \qquad I_n = \mathrm{max}\left( b_{n} - B_\mathrm{prev.} \right), \qquad Q_n = \sum^{69}_{j=1} b_{j,\,n} - B_\mathrm{prev.}. 
\end{equation}

In \cite{satoUUBDAQRelease2024} $B_\mathrm{prev.}$ is the baseline $B$ of the 
previous \DAQ interval. That is to say, $B_\mathrm{prev.}$ gives the mean of 
the first bin of all traces of the previous \SI{61}{\second} interval that was
analyzed \cite{satoUUBDAQRelease2024}. The distributions of $I_n$ and $Q_n$ are
logged in histograms with predefined binning 
\cite{bertouCalibrationSurfaceArray2006}. An example histogram for the \SSD
charge, \Qmip, is shown in \cref{fig:ssd-histo}. Similar histograms are 
constructed for all \WCD \LPMTs, and updated every \SI{61}{\second}. Upon a 
\TTHREE request from the \CDAS, all histograms are sent to the central server 
and used to approximate the minute values of \Ivem, \Qvem, \Imip, and \Qmip \todo{ref here}.

\subsection{Event Detection}
\label{ssec:sd-triggers}

The autonomy of the \SD-stations requires them to independently recognize when
an \EAS passes through them. Several algorithms are in place to detect detector
data that deviates from the electronic noise, or low-threshold pulses from 
atmospheric muons. If an \EAS candidate is observed by the local station a 
\acfp{T2} is sent to the \CDAS. All station level trigger algorithms presented 
here have been in operation since many years, with the majority being present 
since the construction of the first \WCD tanks 
\cite{thepierreaugercollaborationPierreAugerObservatory1997}. 

Importantly, this means that the various trigger hyperparameters are optimized 
for \UB electronics, which have a \SI{40}{\mega\hertz} sampling rate 
(\SI{25}{\nano\second} binning), compared to what is in use today in the \UUB 
(\SI{120}{\mega\hertz} sample rate, \SI{8.333}{\nano\second} binning). To 
address this, the same trigger algorithms that were in use for the \UB are 
operated with the same hyperparameters in a compatibility mode, where incoming 
\UUB detector data is filtered and downsampled to resemble \UB data. More 
specifically, a \acf{FDS} fake \UB trace $f$ (containing 682 samples) is 
calculated from a weighted sum of the \acf{FBW} trace $b$ (2048 samples) 
according to \cref{eq:filter-and-downsample} 
\cite{convengaLocalStationCalibrationDummies2023}.

\begin{equation}
\label{eq:filter-and-downsample} 
f_i = \frac{1}{2048} \sum^{2 n}_{j = 0} b_{3i+p-j} \, \mathrm{FIR}_{n - \left| j-n \right|}, \qquad p = \left\{ 0, 1, 2 \right\}.
\end{equation}

In \cref{eq:filter-and-downsample}, $p$ gives a phase offset for the 
downsampling of the filtered trace, and is essentially random, and based on the
uptime of the \FPGA. The \FIR weights applied to the \FBW trace are given as
$\mathrm{FIR} = \left\{ 5, 0, 12, 22, 0, -61, -96, 0, 256, 551, 681 \right\}$, 
and $n=10$. The normalizing factor $2048$ differs slightly from 
$\sum^{2n}_{j=0} \mathrm{FIR}_{n-\left| j-n \right|} = 2059$, and is chosen 
because the division by $2048 = 2^{11}$ can be realized by a bit shift to the 
right. A comparison between a \FBW and \FDS trace of the same physical signal 
are shown in \cref{fig:filter-and-downsample}.

\subsubsection{Threshold Trigger}
\label{sssec:threshold-t2}

\begin{figure}[t]
  \centering
  \includegraphics[width=1.0\textwidth]{auger-observatory/trigger_hierarchy.png}
  \caption{The trigger hierarchy and logic on the \TTWO and \TTHREE level for 
  the \SD. $\mathrm{I}^\mathrm{peak}_\mathrm{VEM}$ in the graphic is labelled 
  \VemOnline throughout the rest of this work (see \cref{sssec:wcd}). From 
  \cite{abrahamTriggerApertureSurface2010}.}
  \label{fig:trigger-hierarchy}
\end{figure}

The simplest form of a station level trigger is a \SB threshold algorithm, that
triggers a \TTWO whenever the \HG channels of all \WCD \LPMTs simulatenously 
exceed the equivalent of \SI{3.2}{\VemOnline} / \SI{3.6}{\VemOnline} / 
\SI{5.0}{\VemOnline} in \ADC counts above baseline for 3 / 2 / 1 working \LPMTs 
respectively. The chosen thresholds stabilize the \TTWO rate generated by this
\SB trigger to $\sim\SI{20}{\hertz}$ \cite{abrahamTriggerApertureSurface2010}.

This trigger rate is much higher than the rate of "real" \EASs (i.e. \TTHREE 
triggers), which measures $\sim\SI{2}{\per\minute}$ for the entire \SD. The 
threshold trigger must consequently have a very poor purity. This is known, but
must be accepted to retain event detection efficiency for inclined showers, 
that might be induced by neutrinos 
\cite{anchordoquiExoticNeutrinoInteractions2006}.

\subsubsection{Time Over Threshold}

The \ToT trigger is an altered version of the threshold trigger. Instead of 
requiring a \SB exceedance of a high threshold, the \ToT scans a window of 120
samples of the \FDS detector signal. For each window and \WCD \PMT, the number 
of bins above a threshold of \SI{0.2}{\VemOnline} are counted. If two or more
\PMTs have a count of $>12$ bins above the threshold, a \TTWO is raised.

Applying a consecutivity requirement not only to the different \PMTs, but also 
to the signal over time presents a simple change to the \SB threshold trigger, 
but drastically improves the purity of the algorithm, as well as decrease the 
trigger frequency of $\sim\SI{2}{\hertz}$.

\subsubsection{Time Over Threshold Deconvoluted}

The \ToTd trigger has the same trigger requirements as the \ToT, with the only
difference being the input data that is fed into the trigger. Before passing 
the \ToTd, the filtered and downsampled detector data is convoluted with a 
kernel that accounts for the exponential decay of light intensity from a single
flash.

\begin{equation}
\label{eq:totd-input}
f^*_i = \left( f_i - f_{i-1} \, e^{-\SI{25}{\nano\second}/\SI{67}{\nano\second}} \right)\,/\,\left( 1 - e^{-\SI{25}{\nano\second}/\SI{67}{\nano\second} } \right).
\end{equation}

\cite{billoirPeakSearchingSurface2002, colemanNewTriggerSettings2018} go into 
further detail and motivates the \SI{25}{\nano\second} in \cref{eq:totd-input} 
as the binning of the \UB, and \SI{67}{\nano\second} is the time constant of 
the exponential decay, as determined by measurements. This reduces the 
exponential tail of the \WCD signal to a series of (in theory) \SB pulses whose
pulse height correlates well with the deposited total signal. The \ToTd has 
been in use in the \SD since 2013, and extend the sensitivity of the \SD 
stations to fainter signals, and lower \EAS primary energies 
\cite{billoirFirstResultsToTd2013}.

\subsubsection{Multiplicity Of Positive Steps}

The \MoPS trigger is the last and most intricate addition to \SD \TTWO triggers
\cite{billoirPropositionImproveLocal13}. Instead of relying on the \WCD signal
amplitude, the \MoPS trigger is sensitive to the signal shape. Specifically, it
scans the \LPMT traces for rising flanks, where consecutive bins show an
increase in \ADC counts. After applying some selection criteria on the scale of
the rising flank (see \cite{colemanNewTriggerSettings2018}), the number of 
detected positive steps in a window of 120 bins is counted. If the number of 
rising flanks exceeds $4$ for at least two \LPMTs, a final check on the 
integral of the \FDS trace is made, that, if it succeeds results in the 
deployment of a \TTWO to the \CDAS.

\subsection{Array Structure}
\label{ssec:array-structure}

The \SD is designed to detect the footprint of an \EAS on the surface of the 
Earth. The choice of a detector segmented into many different sub-components is
deliberate. Operating a detector with a continous active region is impractical, 
as \EASs can reach many kilometers in extent. It is sufficient to probe the 
shower footprint at select few positions and reconstruct the \EAS from this 
limited knowledge. As already realized by Pierre Auger, the separation between 
sampling points influences the types of air showers that can be detected 
\todo{ref here}. The lower the separation, the more low-energy \EAS become 
observable.

Already before the construction of the \PAO it was decided that the \SD will 
host sub-arrays of different sizes and separations 
\cite{watsonDevelopmentPierreAuger}. This ensures that the observatory can 
make accurate measurements of \EAS over many decades of energy. 
\cref{tab:sub-array-details} lists the most important characteristics of the 
individual sub-arrays. In all of them, the stations are arranged on a grid of 
isoceles triangles. The SD-1500, or main array, is the largest of the three 
existing grids. It is currently the detector with the highest accumulated 
exposure to \CRs worldwide \cite{aabPierreAugerObservatory2020}.

Inset in the north-west of the SD-1500 are the SD-750 (Infill), and SD-433
(compare \cref{fig:auger-map}). Their vicinity to \CO and \HEAT ensure that the 
hybrid reconstruction (see \cref{sec:event-reconstruction}) of \EAS remain 
possible also for energies below \SI{1e17}{\eV}
\cite{mathesHEATTelescopesPierre2011}. Contained within both arrays are several
\RND environments, such as the \AERA \cite{fuchsAugerEngineeringRadio2012}, or 
IceCube@Auger \cite{schroederIceTopAuger2025}. 

The Infill is also home to doublet and triplet detectors, where two 
\SD-stations (with e.g. different electronics) are installed at the same site. 
They are used to study timing offsets and (un)certainties, as well as verify 
the correct operation of the upgraded AugerPrime electronics 
\cite{payerasCompatibilityUBUUB2023}.

\begingroup
\renewcommand{\arraystretch}{1.0}
\begin{table}
	\begin{center}
	\caption{Characteristics of the different \SD sub-arrays}
	\begin{tabular*}{1.0\textwidth}{@{\extracolsep{\fill}} l|ccccl}
  \toprule
	\hline
	Array & Sep. & Stations & Area & full efficiency\tablefootnote{The full
	efficiency gives the minimum energy for which the detection of the \EAS
	is guaranteed.} & Station components \\
	\hline
	\textbf{SD-1500} & \SI{1500}{\meter} & 1669 & 
	\SI{3000}{\kilo\meter\squared} & 
	\SI{3e18}{\eV} \cite{abrahamTriggerApertureSurface2010} & \WCD, \SSD, 
	\RD \\
	\textbf{SD-750} & \SI{750}{\meter} & 61 & \SI{25}{\kilo\meter\squared} &
	\SI{3e17}{\eV} \cite{fenuCosmicRayEnergy2023} & \WCD, \SSD, \RD, \UMD \\
	\textbf{SD-433} & \SI{433}{\meter} & 19 & \SI{2}{\kilo\meter\squared} &
	\SI{5e16}{\eV} \cite{silliPerformance433Surface2022a}\tablefootnote{for 
	hadronic primaries with $\theta < 45^\circ$} & \WCD, \SSD, \RD \\
  \bottomrule
	\end{tabular*}
	\label{tab:sub-array-details}
	\end{center}
\end{table}
\endgroup

\section{Event Reconstruction}
\label{sec:event-reconstruction}

\subsection{Event Detection}
\label{ssec:cdas}

The first action in the chain of \EAS event reconstruction is the detection of
an air shower. Based on the hybridity of the observatory, this happens in a 
twofold way. Common to either case is the principle of a hierarchical trigger
structure, where detector information is processed in-situ where possible, and 
forwarded only if certain (trigger) conditions are met. The identification of
an \EAS event the \PAO starts with an \acf{T3}, that occurs at the level
of the \acf{CDAS}.

\subsubsection{Fluorescence Detector}

The lower level triggers analyzing pixel, pixel column, and camera data have 
been introduced in \cref{ssec:fd-triggers}. There, a \acf{TLT} represents the 
stage at which it has been determined that an \FD-camera has seen an \EAS.
\TLTs from all telescopes in a building are analyzed for events that pass the 
\FOV of multiple cameras. Every \TLT is treated as a \FD-\TTHREE at the \CDAS 
level, denoting an \EAS event detection by the fluorescence telescopes. 
Possible hybrid events are checked for by comparing coincident \FD and \SD 
\TTHREEs. In the case of the \SD not detecting an \EAS the approximate impact 
time of the \EAS on ground is calculated via a preliminary reconstruction of 
the \FD detector data. Stations closest to the given \FD building are checked 
for \TTWOs that lie within \SI{20}{\micro\second} of this core time. If any 
station has a matching trigger, it is added to the event
\cite{abrahamFluorescenceDetectorPierre2010, 
thepierreaugercollaborationPierreAugerCosmic2015}.

\subsubsection{Surface Detector}

\begin{figure}[t]
  \centering
  \subfloat[]{\includegraphics[height=0.33\textwidth]{auger-observatory/t3_vertical_mode.png}
  \label{fig:t3-vertical}
  }\hspace{0.2cm}
  \subfloat[]{\includegraphics[height=0.33\textwidth]{auger-observatory/t3_horizontal_mode.png}
  \label{fig:t3-horizontal}
  }
  \caption[]{\subref{fig:t3-vertical} Example configuration for a 
  $\ToT2C_1\&3C_2$ \TTHREE trigger made up of \ToT-like \TTWOs exclusively. 
  Only the number of triggered stations within a crown matters, not their 
  positioning. \subref{fig:t3-horizontal} Station trigger configuration that 
  would result in a $2C_1\&3C_2\&4C_4$. Only one of the stations in the two 
  outermost crowns is required to form the \TTHREE.}
  \label{fig:}
\end{figure}

For the \SD, the trigger hierarchy is based on the \acfp{T2} detailed in 
\cref{ssec:sd-triggers}. Every station sends a list if its' \TTWO candidate 
events to the \CDAS, along with a high-precision timestamp when the event 
occured. The \CDAS analzyes the spatial and temporal distribution of \TTWOs for
coincidences, as these may be caused by \EASs. For any \TTWO at a candidate 
station, the surrounding crowns $C_1, ..., C_4$ representing the sets of  
$1\mathrm{st}, ..., 4\mathrm{th}$ nearest neighbor stations are analyzed for 
coincident \TTWO triggers. Due to the finite speed of light, a grace period of 
$(6 + 5n)\,\mathrm{ns}$ is allowed for a station in $C_n$ to be coincident with
the candidate station \cite{abrahamTriggerApertureSurface2010}. Two scanning 
strategies are utilized when searching for \acfp{T3}. Both rely on a 
compactness criteria of the underlaying \TTWOs.

The $\ToT2C_1\&3C_2$ mode requires all participating station triggers to be 
\ToT-like, meaning \ToT, \ToTd, or \MoPS. Then, at least two \ToT-like stations
(including the central station $C_0$) are required within $C_1$, and at least 
three triggered stations must exist up to the $2\mathrm{nd}$ nearest neighbors 
in $C_2$. \cref{fig:t3-vertical} gives example trigger configurations that 
result in a $\ToT2C_1\&3C_2$ \TTHREE.

An example of the second mode, the $2C_1\&3C_2\&4C_4$ \TTHREE trigger is shown
in \cref{fig:t3-horizontal}. It accepts any kind of \TTWO, namely the noisy 
threshold trigger (refer to \cref{sssec:threshold-t2}). It requires four 
active stations. At least two stations (including the central station) in 
$C_1$, at least three within $C_2$, and at least one more trigger anywhere 
within $C_3$ or $C_4$.

Due to their respective selection criteria, both trigger configurations have 
their own use case. The $\ToT2C_1\&3C_2$, due to the underlaying local triggers
providing an excellent background rejection, has a fraction of true \EAS events
that surpasses \SI{95}{\percent} \todo{cite/write proceeding}. It provides the
main trigger mode for showers impinging on the array with an inclination of up 
to $\sim\SI{60}{\degree}$. Higher inclination showers are attenuated more 
strongly due to having passed more atmosphere. Usually, the \EM component of 
horizontal \EASs gets thermalized before the shower reaches the ground, and 
only the muonic component survives. This results in short, strong pulses and 
threshold \TTWOs being recorded in the local stations.  It is thus the main 
trigger for highly inclined shower events, at the cost of a purity of only 
\SIrange{3}{10}{\percent} \todo{proceeding} \cite{todo, abrahamTriggerApertureSurface2010}.

\subsubsection{Event selection}

The purity of the \SD-\TTHREEs especially is very poor. To combat this, 
fiducial triggers need to be employed before the event reconstruction can take
place. Immediately after a \TTHREE is issued and low-level detector data is 
sent to the \CDAS, a T4 trigger rejects \TTHREE candidates whose participating
station trigger timings do not fit a plane front hypothesis. Essentially, this 
identifies \TTHREEs that are formed on the basis of random coincidences of 
\TTWOs. The ratio of real \EAS events over generated T4s is about 
\SIrange{98}{100}{\percent} \cite{abrahamTriggerApertureSurface2010}.

A final T5 check requires the station that received the most signal to have all
6 nearest neighbour stations existing and functioning. While the requirement 
reduces the effective size of the \SD-array by about \SI{10}{\percent} 
\cite{abrahamTriggerApertureSurface2010}, it ensures the reconstructed 
quantities are not biased by the geometry of the array, which occurs especially
at the edges of the \PAO. 

\subsection{\Offline Reconstruction}

\begingroup
\renewcommand{\arraystretch}{1.2}
\begin{table}[T]
	\begin{center}
	\caption{List of quantities that are reconstructed during a standard 
	\EAS reconstruction.}
	\begin{tabular*}{1.0\textwidth}{M{0.6cm}M{1.7cm}M{1.1cm}|M{7.25cm}|M{2.6cm}}
  \toprule
	 & $\mathbf{Q}$ & $\mathbf{\Delta Q}$ & Details & Ref. \\
	\cline{2-5}
	\ldelim\{{5}{*}[\parbox{4mm}{\rotatebox[origin=c]{90}{Event level}}]
	 & $E_\mathrm{SD}$ & \SI{14}{\percent} & The energy of the primary 
	 particle, estimated from \SD data only & \\
	 & $E_\mathrm{FD}$ & \SI{14}{\percent} & \FD-estimate of the primary
	 energy & \\ 
	 & $(\theta, \phi)$ & \SI{1}{\percent} & Arrival direction of the 
	 primary particle & \\
	 & $(x, y)$ & \SI{10}{\percent}\tablefootnote{The percentage
 	 uncertainty is given in terms of the SD-1500 array spacing 
	 (\SI{1.5}{\kilo\meter})} & Intersect of \EAS axis and Earth surface 
	 & \\ 
	 & $\Xmax$ & \SI{50}{\percent} & Atmospheric depth at the max. \EAS 
	 size & \\
	 \cline{2-5}
	\ldelim\{{9}{*}[\parbox{4mm}{\rotatebox[origin=c]{90}{Station/Telescope
	level}}]
	 & \Ivem/\Qvem & \SI{2}{\percent} & Calibration factors for the \WCD 
	 \LPMTs & \cref{sssec:reconstruction-histogram-fitter} \\
	 & \Imip/\Qmip & \SI{2}{\percent} & Calibration factors for the \SSD 
	 \PMT & \cref{sssec:reconstruction-histogram-fitter} \\
	 & $Q^\mathrm{total}_\mathrm{VEM}$/$Q^\mathrm{total}_\mathrm{MIP}$ &
	 $\sim\SI{5}{\percent}$ & Integrated signal received by the \SD \PMTs &
	 \cref{sssec:reconstruction-trace-calibrator} \\
	 & & & & \\
	 & & & & \\
	 & & & & \\
	 & & & & \\
	 & & & & \\
	 & & & & \\
\bottomrule
	\end{tabular*}
	\label{tab:rec-quantities}
	\end{center}
\end{table}
\endgroup

\Offline is the extensive in-house software framework utilized by the Auger 
collaboration to reconstruct \EAS data and perform detector studies
\cite{argiroOfflineSoftwareFramework2007}. It is written in \texttt{C++}
\cite{stroustrupStandard}, and is continuously updated by collaborators using 
\texttt{git} \cite{thepierreaugercollaborationOfficialOfflineRepository2025,
chaconProGit2014}. A deliberate design choice of the project is the 
compartmentalization of the reconstruction process into different modules.

During an \EAS reconstruction, these modules are executed in a predefined 
sequence as defined in \XML steering files. Every module has a specific use 
case, and reconstructs different \EAS information. Consequentially, the 
module sequence defines which measurement data is analyzed, and which \EAS 
information is reconstructed. Usually, at the end of the procedure the results 
of the analysis are written to an \ADST, a compact data structure based on the 
\texttt{root} format \cite{brunROOTObjectOriented1997}. 

This section details the different modules that are executed during a standard
hybrid event reconstruction. The \UMD and the \RD are not part of this module
sequence. Details on the event reconstruction using the \UMD and the \RD data 
are offered in \cite{bottiAMIGAUndergroundMuon2021} and \todo{simons proceeding}. 

The goal of the reconstruction is the collection of several event-level 
quantities that can be used for higher-level physics analysis. An overview of 
the most important reconstructed information is given in 
\cref{tab:rec-quantities}.
\subsubsection{PMT Quality Cuts \& Station Selection}
\label{sssec:reconstruction-pmt-quality-cuts}

It follows a discussion of several modules that, for the sake of clarity, are 
grouped together in one section. They all have a common purpose in a first 
level processing of the raw \SD detector data, and ensuring it is of good 
quality.

First, quality cuts are applied to the \WCD \LPMTs that check several variables
relating to the functionality of the \PMT. Namely, \PMTs are flagged as bad if
\VemOnline or the standard deviation of the online estimated baseline (ref.
\cref{eq:peak-and-charge}) are outside of predefined ranges. The \LG-channel of
the \PMT is flagged as bad if the dynode-to-anode ratio of the \PMT is outside
of a nominal range. Stations for which none of the \LPMTs pass the selection 
criteria receive a "rejected" status, that removes them from participating in 
the event reconstruction.

Next, the dynode-to-anode ratio, the \TTWO timestamp, as well as the \GPS
information of the surviving stations are adjusted and corrected according to 
\LUTs that keep track of station-level software/hardware changes and problems 
that influence any of the quantities.

Additionally to the quality cuts on a \PMT level, stations are also checked for
their \TTWO lifetime\footnote{\todo{wtf is this}}, quality of the \GPS timing 
information, data integrity, and many other aspects. Individual stations are 
flagged as rejected if any of the assertions made in the process fail.

\subsubsection{SdHistogramFitterKG}
\label{sssec:reconstruction-histogram-fitter}

Rate-based estimators for \Ivem and \Imip exist on the station-level (ref. 
\cref{sssec:wcd}, \todo{online mip reference}). During event reconstruction, a
more robust method of estimating the peak and charge of the \LPMTs and the
\SSD-\PMT are used. As detailed in \cref{sssec:muon-histograms}, information 
exists on the distribution of pulse heights and integrals for the different 
\PMTs in the \SIrange{1}{2}{\minute} leading up to the event (ref. 
\cref{fig:ssd-histo}). Crucially, all these histograms show a local maximum 
that can be identified with the most probable peak/charge from a single 
atmospheric muon.

A second order polynomial is fitted to the counts in these histograms. The 
vertex of the parabola is coincident with \Ivem/\Qvem/\Imip/\Qmip\footnote{up 
to zenith-dependent corrections.}. It represents the histogram-based estimate 
of the \WCD and \SSD calibration factors, and is accurate to within 
$\sim\SI{2}{\percent}$ \cite{bertouCalibrationSurfaceArray2006, 
filipCalibrationScintillatorSurface2025}

\subsubsection{SdBaselineFinderKG}
\label{sssec:reconstruction-baseline-finder}

The \PMT baseline estimate is equally revisited. An algorithm scans the
trace before and after the \EAS signal, and builds a running baseline estimate
that accounts for \PMT undershoot \todo{cite?}, electronic fluctuations and 
other hardware effects that falsify the physical signal \cite{tobiasUB, tobiasUUB}.

\subsubsection{SdTraceCalibratorOG}
\label{sssec:reconstruction-trace-calibrator}

With the knowledge of the bin-by-bin baseline $b_i$, as well as the calibration
constants as determined above, the individual \FADC \PMT-traces are calibrated
according to \cref{eq:offline-calibration}.

\begin{equation}
\label{eq:offline-calibration}
s^\mathrm{VEM/MIP}_i = \left( s^\mathrm{ADC}_i - b_i \right)\,/\,I_\mathrm{VEM/MIP}.
\end{equation}

Furthermore, the signal window is determined according to the procedure defined
in \cite[Sec. 3.3 of][]{aabReconstructionEventsRecorded2020}. Regions where the
trace exceeds \SI{3}{\ADC} above baseline are identified as signal fragments. 
These signal pieces are iteratively combined under two conditions. Fragment B
must start latest $\SI{500}{\nano\second} + t_A$ after fragment A, that has a 
duration $t_A$, ends. Additionally, the segments are only merged if the charge 
$Q$ or peak $I$ of both windows fulfill the conditions $Q_A > 0.3\,Q_B$, or 
$I_B < 5\,\Ivem$. Both checks ensure the exclusion of random coincidences 
stemming from atmospheric muons.

Once no trace segments are left to merge, the window with the longest duration
is chosen for each \WCD \PMT, and the \EAS start and stop time are calculated 
as the average of the \PMT start/stop times. A buffer time of 
\SI{250}{\nano\seconds} is appended to the stop time, to ensure containment of
any sub-threshold pulses. The integral of the \FADC trace within the determined
signal window is calculated and divided by the corresponding charge calibration
factor. The recovered quantity is the total \EAS signal 
$Q^\mathrm{total}_\mathrm{VEM}$/$Q^\mathrm{total}_\mathrm{MIP}$.

The uncertainty of the total estimated signal is highly non-linear, and
increases from \SI{5}{\percent} for smaller signals to \SI{60}{\percent} at 
very large signals of $\sim\SI{10}{\kilo\VEM} 
\cite{aabReconstructionEventsRecorded2020}.

\subsubsection{SdSignalRecoveryKLT}
\label{sssec:reconstruction-signal-recovery}

The station-level hardware encodes the \PMT signals using 11-bits. This means 
that signals exceeding $2^{11}-1 = \SI{2047}{\ADC}$ cannot be represented and 
the trace becomes saturated. For the (amplified) \HG-channels, this is observed
for signal amplitudes exceeding very roughly 
$\SI{14}{\Ivem}\,/\,\SI{50}{\Imip}$. The relevant detector information is 
reconstructed from the \LG channel in the case of a \HG-saturated \PMT. For
very high signals ($\sim\SI{440}{\Ivem},/\,\sim\SI{1600}{\Imip}$), the \LG
trace also becomes saturated, and needs to be recovered accurately. In such 
cases a signal recovery algorithm \cite{vebericEstimationSignalSaturated2013}
estimates the total charge 
$Q^\mathrm{total}_\mathrm{VEM}$/$Q^\mathrm{total}_\mathrm{MIP}$ by fitting a 
Moyal distribution \cite{moyalXXXTheoryIonization1955} to the unsaturated part
of the \PMT trace, accounting for \PMT undershoot in the process
\cite{vebericEstimationSignalSaturated2013}.

\subsubsection{FdCalibratorOG}
\label{sssec:reconstruction}

After the \SD data is processed, the \FD data needs to be calibrated in a
similar fashion. For this purpose, 

\subsubsection{FD axis shit}

\subsubsection{HybridGeometryFinderOG/WG}
\subsubsection{FdApertureLightKG}
\subsubsection{FdEnergyDepositFinderKG}

\subsubsection{SdReco TODO!}
